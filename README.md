# Cloud-Based SIEM & EDR Security Architecture (Multi-OS)


---


##  1. Project Overview
This project demonstrates the deployment of a **cloud security monitoring solution** that combines **SIEM (Security Information and Event Management)** and **EDR (Endpoint Detection and Response)** using **Wazuh**.

The infrastructure is hosted on **AWS Learner Lab** and monitors **Linux and Windows systems simultaneously**, reproducing a realistic enterprise environment. The goal is to provide centralized visibility, real-time detection, and security event analysis across heterogeneous endpoints.

---

##  2. Project Objectives
- Deploy a complete **SIEM & EDR architecture in the cloud**
- Centralize security logs from multiple operating systems
- Monitor authentication, privilege escalation, and system integrity
- Understand **SIEM vs EDR** concepts and use cases
- Practice **Threat Hunting** using Wazuh queries
- Analyze **IAM / PAM-related security events**
- Apply cloud security best practices

---

##  3. Global Architecture

###  Cloud Infrastructure (AWS)
The lab environment consists of:
- 1 VPC  
- 1 Subnet  
- 3 EC2 Instances  
- Multiple Security Groups  

All instances are deployed within the same subnet to simplify communication while security is strictly enforced using Security Groups.

---

###  4. Architecture Components

####  4.1 Wazuh Server (Ubuntu)
- **OS:** Ubuntu 22.04 LTS  
- **Instance Type:** t3.large  
- **Storage:** 30 GB  
- **Components Installed:**
  - Wazuh Manager
  - Wazuh Indexer
  - Wazuh Dashboard

The Wazuh server acts as the **central SIEM & EDR platform**, collecting, correlating, and visualizing security events.



####  4.2 Linux Client (Ubuntu)
- **OS:** Ubuntu 22.04 LTS  
- **Instance Type:** t2.micro  
- **Storage:** 8 GB  
- **Monitoring:** Wazuh Agent  

Collected data:
- SSH authentication attempts
- sudo privilege escalation
- System logs
- File Integrity Monitoring (FIM)


####  4.3 Windows Client (Windows Server)
- **OS:** Windows Server  
- **Instance Type:** t2.medium  
- **Storage:** 30 GB  
- **Monitoring:** Wazuh Agent + Sysmon  

Collected data:
- Windows Security Events
- Failed logon attempts
- User and group management
- Process creation and system activity

---

##  5. Network Security Design


### Allowed Network Flows

| Source        | Destination     | Port | Purpose |
|--------------|-----------------|------|--------|
| Admin IP     | All EC2         | 22   | SSH access |
| Admin IP     | Windows Client  | 3389 | RDP access |
| Linux Agent  | Wazuh Server    | 1514 | Agent communication |
| Windows Agent| Wazuh Server    | 1514 | Agent communication |
| Agents       | Wazuh Server    | 1515 | Agent enrollment |
| Admin IP     | Wazuh Server    | 443  | Dashboard access |



---

##  6. Wazuh Deployment

The Wazuh platform is installed in **All-in-One mode**, suitable for lab and proof-of-concept environments.

The installation includes:
- Wazuh Manager  
- Wazuh Indexer  
- Wazuh Dashboard  
- Default detection rules  

After deployment, the dashboard allows:
- Agent management  
- Security alert monitoring  
- Event correlation  
- Threat hunting  

---

##  7. Agent Deployment

### 7.1 Linux Agent
- Installed directly from the Wazuh Dashboard  
- Starts sending logs immediately after installation  

Monitored data includes:
- SSH login attempts  
- sudo usage  
- System logs  
- File integrity events  



### 7.2 Windows Agent
- Installed using PowerShell commands generated by the dashboard  
- Runs as a Windows service  

Collected data includes:
- Windows Security Logs  
- Failed logon attempts  
- User and group changes  

---

##  8. Security Scenarios & Detection

### 8.1 Linux (SIEM)
- Failed SSH login attempts
- sudo command usage  
- Modification of sensitive system files  

Generated alerts:
- Authentication failures  
- Privilege escalation  
- File integrity violations  



### 8.2 Windows (EDR)
- Event ID 4625 – Failed Logon
- Event ID 4720 – User Created
- Event ID 4732 – User added to Administrators group

These scenarios demonstrate **IAM and PAM monitoring capabilities**.

---

##  9. SIEM vs EDR Comparison

| Criteria | SIEM | EDR |
|-------|-----|-----|
| Scope | Global infrastructure | Individual endpoints |
| Data | Logs | Processes, files, registry |
| Detection | Rule-based | Behavioral |
| Use case | Compliance, monitoring | Threat detection, response |

 **Wazuh combines both SIEM and EDR**, offering a unified security monitoring solution.

---

##  10. Threat Hunting
Threat hunting was performed using custom Wazuh queries:
### Example Hunts
- Repeated SSH authentication failures (brute force detection)
- File modifications in `/etc/`
- Creation of Windows users with administrative privileges

### Methodology
1. Formulate a threat hypothesis  
2. Investigate using targeted queries  
3. Analyze and correlate events  

This proactive approach allows detection of threats that may bypass automated alerts.

---

##  11. Conclusion
This project successfully demonstrates the deployment of a **cloud-based SIEM & EDR architecture** using Wazuh on AWS. It highlights how centralized monitoring, multi-OS supervision, and real-time detection can significantly improve security visibility and incident response in modern cloud environments.

---

## 12. Author
**Chaimaa Zandar**  
Engineering Student – GLSID 
ENSET Mohammedia
Academic Year: 2025/2026


